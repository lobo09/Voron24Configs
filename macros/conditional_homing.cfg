# Conditional G28 (home if not already homed)
[gcode_macro CONDITIONAL_HOMING]
gcode:
  CG28
  
[gcode_macro CG28]
gcode:
    {% if "x" not in printer.toolhead.homed_axes or "y" not in printer.toolhead.homed_axes or "z" not in printer.toolhead.homed_axes %}
    G28
    {% endif %}