[gcode_macro MOVE_TO_FRONT]

variable_z_pos_min: 120                                  ; minimum z pos

gcode:
  SAVE_GCODE_STATE NAME=MOVE_TO_FRONT
  G90                                                    ; absolute mode
  
  {% if "z"  in printer.toolhead.homed_axes and printer.toolhead.position.z < z_pos_min %} ; if z is homed and below min pos
      G0 X150 Y0 Z{z_pos_min} F9000                      ; move to front and up
  {% else %}
      G0 X150 Y0 F9000                                   ; move to front
  {% endif %}                                           
  
  M400                                                   ; wait until all moves are finished
  RESTORE_GCODE_STATE NAME=MOVE_TO_FRONT